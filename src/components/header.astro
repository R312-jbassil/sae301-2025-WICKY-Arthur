---
const user = Astro.locals.user;
---

<header>
    <div class="z-1 navbar bg-transparent flex flex-col sm:flex-row items-center py-4 sm:py-8 gap-4 sm:gap-2">
        <a href="/" class="flex-shrink-0">
            <img
                src="/src/assets/images/logo_header.svg"
                alt="Logo"
                class="h-10 sm:h-12"
            />
        </a>

        <div class="w-full flex justify-center sm:justify-between items-center">
            <div class="hidden sm:block"></div>
            <ul class="flex flex-wrap justify-center gap-4 sm:gap-6 text-sm sm:text-base">
                <li><a href="/generator">Générateur</a></li>
                <li><a href="/galerie">Galerie</a></li>
                {user ? (
                    <li>
                        <button id="logout-btn" class="cursor-pointer hover:underline">
                            Se déconnecter
                        </button>
                    </li>
                ) : (
                    <li><a href="/login">Connexion</a></li>
                )}
                <li>
                    <a href="/">
                        <img
                            src="/src/assets/images/cart.svg"
                            alt="Panier"
                            class="h-6 w-6 sm:h-7 sm:w-7"
                        />
                    </a>
                </li>
            </ul>
        </div>
    </div>
</header>

{user && (
    <script>
        const logoutBtn = document.getElementById('logout-btn');
        if (logoutBtn) {
            logoutBtn.addEventListener('click', async () => {
                const res = await fetch('/api/logout', {
                    method: 'POST',
                    credentials: 'include',
                });
                
                if (res.ok) {
                    localStorage.removeItem('user');
                    window.location.href = '/';
                }
            });
        }
    </script>
)}
